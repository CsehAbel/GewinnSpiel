<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui" 
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

<ui:composition template="../KekSablon.xhtml">
<ui:define name="head">
	<h:outputStylesheet name="css/newfile.css"></h:outputStylesheet>
</ui:define>
<ui:define name="szalag">
		<h:form id="somFormId" class="somForm">
			<h:selectOneMenu id="terulet" value="#{dbManager.t}" onchange="#{dbManager.valaszt()}">
				<f:selectItems value="#{dbManager.teruletek}" ></f:selectItems>
				<f:ajax execute="somFormId" render="somFormId tablazat somForm2Id"></f:ajax>
			</h:selectOneMenu>
		</h:form>
		
		<h:form id="somForm2Id" class="somForm2">
			<h:selectOneMenu id="beosztas" value="#{dbManager.b}" onselect="#{dbManager.bvalaszt()}">
				<f:selectItems value="#{dbManager.beosztasok}" ></f:selectItems>
				<f:ajax execute="somForm2Id tablazat" render="tablazat somForm2Id"></f:ajax>
			</h:selectOneMenu>
		</h:form>
		
		<script>
	    function foo(element) {
	        var $element = $(element);
	        return $element.children(0).text();
	    }
		</script>
		
		<h:form id="tablazat">
			<p:dataTable id="dtable" var="u" value="#{dbManager.userek}"  widgetVar="userTable">
				<p:ajax event="filter"  update="@all"/>
				
				<f:facet name="header">
					<ui:repeat var="betu" value="#{dbManager.abc}">
					<p:commandButton  value="#{betu}" onclick="$('#tablazat\\:dtable\\:col_filter').val(foo(this)),PF('userTable').filter()">
					</p:commandButton>
					</ui:repeat>
					<p:commandButton value="Mindenki" action="#{navigationBean.redirectToNewFile()}"></p:commandButton>
		        </f:facet>
		        
		        <p:column id="col" filterBy="#{u.nev}">
		        <f:facet name="filter">
		        	<p:inputText id="col_filter" style="visibility:hidden;"/>
		        </f:facet>
		          <p:commandButton value="#{u.nev}"  action="#{navigationBean.redirectToMegerosites()}">
		        	<f:setPropertyActionListener value="#{u}" target="#{dbManager.u}" />
	          	  </p:commandButton>
		        </p:column>
		        
		         <p:column>
		          <h:outputText value="#{u.torzsszam}" />
		        </p:column>
			</p:dataTable>
	    </h:form>
	   
	    <h:form id="cForm">
			<table>
				<c:forEach var="j" begin="0" end="2">
				<tr>
				<c:forEach var="i" begin="1" end="3">
		          <td>
			          <h:commandButton action="#{dbManager.concd((j*3)+i)}" value="#{(j*3)+i}">
			          	<f:ajax execute="@this" render="cForm tablazat"/>
			          </h:commandButton>  
		          </td>
	        	</c:forEach> 
	        	</tr>
	        	</c:forEach>
				<tr>
					<td><h:commandButton action="#{dbManager.concd(0)}" value="#{0}">
			          		<f:ajax execute="@this"  render="cForm tablazat"/>
			            </h:commandButton> </td>
					<td><h:commandButton action="#{dbManager.backsd()}" value="Törlés">
			          		<f:ajax  execute="@this" render="cForm tablazat"/>
			            </h:commandButton></td>
				</tr>
			</table>
			<label id="lbld">#{dbManager.d}</label>
		</h:form>
</ui:define>
</ui:composition>
</html>
